"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const aws_sdk_1 = require("aws-sdk");
const utils_1 = require("../../utils");
const apartmentEntity_1 = require("./entities/apartmentEntity");
async function createApartment(appsyncInput, logger) {
    const documentClient = new aws_sdk_1.DynamoDB.DocumentClient();
    let tableName = process.env.ACMS_DB;
    const createdOn = Date.now().toString();
    const id = (0, utils_1.uuid)();
    if (tableName === undefined) {
        logger.error(`Couldn't get the table name`);
        tableName = "AcmsDynamoDBTable";
    }
    const apartmentInput = new apartmentEntity_1.ApartmentEntity({
        id: id,
        ...appsyncInput.input,
        createdOn,
    });
    logger.info(`create apartment input info", ${apartmentInput}`);
    const params = {
        TableName: tableName,
        Item: apartmentInput.toItem(),
    };
    try {
        await documentClient.put(params).promise();
        return apartmentInput.graphQLReturn();
    }
    catch (error) {
        logger.error(`an error occured while creating an apartment ${error}`);
        throw Error(`an error occured ${error}`);
    }
}
exports.default = createApartment;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQXBhcnRtZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlQXBhcnRtZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EscUNBQW1DO0FBQ25DLHVDQUFtQztBQUduQyxnRUFBNkQ7QUFFN0QsS0FBSyxVQUFVLGVBQWUsQ0FDNUIsWUFBa0MsRUFDbEMsTUFBYztJQUVkLE1BQU0sY0FBYyxHQUFHLElBQUksa0JBQVEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUNyRCxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQztJQUNwQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDeEMsTUFBTSxFQUFFLEdBQVcsSUFBQSxZQUFJLEdBQUUsQ0FBQztJQUUxQixJQUFJLFNBQVMsS0FBSyxTQUFTLEVBQUU7UUFDM0IsTUFBTSxDQUFDLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1FBQzVDLFNBQVMsR0FBRyxtQkFBbUIsQ0FBQztLQUNqQztJQUVELE1BQU0sY0FBYyxHQUFvQixJQUFJLGlDQUFlLENBQUM7UUFDMUQsRUFBRSxFQUFFLEVBQUU7UUFDTixHQUFHLFlBQVksQ0FBQyxLQUFLO1FBQ3JCLFNBQVM7S0FDVixDQUFDLENBQUM7SUFFSCxNQUFNLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxjQUFjLEVBQUUsQ0FBQyxDQUFDO0lBQy9ELE1BQU0sTUFBTSxHQUFHO1FBQ2IsU0FBUyxFQUFFLFNBQVM7UUFDcEIsSUFBSSxFQUFFLGNBQWMsQ0FBQyxNQUFNLEVBQUU7S0FDOUIsQ0FBQztJQUVGLElBQUk7UUFDRixNQUFNLGNBQWMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDM0MsT0FBTyxjQUFjLENBQUMsYUFBYSxFQUFFLENBQUM7S0FDdkM7SUFBQyxPQUFPLEtBQVUsRUFBRTtRQUNuQixNQUFNLENBQUMsS0FBSyxDQUFDLGdEQUFnRCxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBQ3RFLE1BQU0sS0FBSyxDQUFDLG9CQUFvQixLQUFLLEVBQUUsQ0FBQyxDQUFDO0tBQzFDO0FBQ0gsQ0FBQztBQUVELGtCQUFlLGVBQWUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvZ2dlciB9IGZyb20gXCJAYXdzLWxhbWJkYS1wb3dlcnRvb2xzL2xvZ2dlclwiO1xuaW1wb3J0IHsgRHluYW1vREIgfSBmcm9tIFwiYXdzLXNka1wiO1xuaW1wb3J0IHsgdXVpZCB9IGZyb20gXCIuLi8uLi91dGlsc1wiO1xuaW1wb3J0IENyZWF0ZUFwYXJ0bWVudElucHV0IGZyb20gXCIuL0NyZWF0ZUFwYXJ0bWVudElucHV0XCI7XG5cbmltcG9ydCB7IEFwYXJ0bWVudEVudGl0eSB9IGZyb20gXCIuL2VudGl0aWVzL2FwYXJ0bWVudEVudGl0eVwiO1xuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBcGFydG1lbnQoXG4gIGFwcHN5bmNJbnB1dDogQ3JlYXRlQXBhcnRtZW50SW5wdXQsXG4gIGxvZ2dlcjogTG9nZ2VyXG4pIHtcbiAgY29uc3QgZG9jdW1lbnRDbGllbnQgPSBuZXcgRHluYW1vREIuRG9jdW1lbnRDbGllbnQoKTtcbiAgbGV0IHRhYmxlTmFtZSA9IHByb2Nlc3MuZW52LkFDTVNfREI7XG4gIGNvbnN0IGNyZWF0ZWRPbiA9IERhdGUubm93KCkudG9TdHJpbmcoKTtcbiAgY29uc3QgaWQ6IHN0cmluZyA9IHV1aWQoKTtcblxuICBpZiAodGFibGVOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICBsb2dnZXIuZXJyb3IoYENvdWxkbid0IGdldCB0aGUgdGFibGUgbmFtZWApO1xuICAgIHRhYmxlTmFtZSA9IFwiQWNtc0R5bmFtb0RCVGFibGVcIjtcbiAgfVxuXG4gIGNvbnN0IGFwYXJ0bWVudElucHV0OiBBcGFydG1lbnRFbnRpdHkgPSBuZXcgQXBhcnRtZW50RW50aXR5KHtcbiAgICBpZDogaWQsXG4gICAgLi4uYXBwc3luY0lucHV0LmlucHV0LFxuICAgIGNyZWF0ZWRPbixcbiAgfSk7XG5cbiAgbG9nZ2VyLmluZm8oYGNyZWF0ZSBhcGFydG1lbnQgaW5wdXQgaW5mb1wiLCAke2FwYXJ0bWVudElucHV0fWApO1xuICBjb25zdCBwYXJhbXMgPSB7XG4gICAgVGFibGVOYW1lOiB0YWJsZU5hbWUsXG4gICAgSXRlbTogYXBhcnRtZW50SW5wdXQudG9JdGVtKCksXG4gIH07XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBkb2N1bWVudENsaWVudC5wdXQocGFyYW1zKS5wcm9taXNlKCk7XG4gICAgcmV0dXJuIGFwYXJ0bWVudElucHV0LmdyYXBoUUxSZXR1cm4oKTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGxvZ2dlci5lcnJvcihgYW4gZXJyb3Igb2NjdXJlZCB3aGlsZSBjcmVhdGluZyBhbiBhcGFydG1lbnQgJHtlcnJvcn1gKTtcbiAgICB0aHJvdyBFcnJvcihgYW4gZXJyb3Igb2NjdXJlZCAke2Vycm9yfWApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUFwYXJ0bWVudDtcbiJdfQ==